# Copyright 2024 Defense Unicorns
# SPDX-License-Identifier: AGPL-3.0-or-later OR LicenseRef-Defense-Unicorns-Commercial

kind: ZarfPackageConfig
metadata:
  name: experimental-gateway-crds
  description: "Uses kustomize to install experimental Gateway API CRDs"
  version: "v1.4.1"

components:
  - name: experimental-gateway-crds
    required: true
    manifests:
      - name: experimental-gateway-crds
        files:
          - https://github.com/kubernetes-sigs/gateway-api/releases/download/v1.4.1/experimental-install.yaml
    actions:
      onDeploy:
        before: 
          # raw-experimental-gateway-crds-experimental-gateway-crds-experimental-gateway-crds is the 
          # “release-name source” that Zarf generates internally when it creates a Helm release for the manifests.files[0]
          - cmd: bash scripts/change-gateway-crd-helm-ownership.sh raw-experimental-gateway-crds-experimental-gateway-crds-experimental-gateway-crds
